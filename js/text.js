var asteroids_game = asteroids_game || {};

asteroids_game.text = (function () {
    var letterPoints = {
        a: [-1, -1, -1, 0.2,
            -1, 0.2, 0, 1,
            0, 1, 1, 0.2,
            1, 0.2, 1, -1,
            -1, -0.2, 1, -0.2],
        b: [-1, 1, 0.6, 1,
            0.6, 1, 1, 0.6,
            1, 0.6, 1, 0.4,
            1, 0.4, 0.6, 0,
            0.6, 0, -1, 0,
            0.6, 0, 1, -0.4,
            1, -0.4, 1, -0.6,
            1, -0.6, 0.6, -1,
            0.6, -1, -1, -1,
            -1, -1, -1, 1],
        c: [1, 1, -1, 1,
            -1, 1, -1, -1,
            -1, -1, 1, -1],
        d: [-1, 1, 0.6, 1,
            0.6, 1, 1, 0.6,
            1, 0.6, 1, -0.6,
            1, -0.6, 0.6, -1,
            0.6, -1, -1, -1,
            -1, -1, -1, 1],
        e: [1, 1, -1, 1,
            -1, 0, 0.4, 0,
            -1, -1, 1, -1,
            -1, 1, -1, -1],
        f: [1, 1, -1, 1,
            -1, 1, -1, 0,
            -1, 0, 1, 0,
            1, 0, -1, 0,
            -1, 0, -1, -1],
        g: [1, 1, -1, 1,
            -1, 1, -1, -1,
            -1, -1, 1, -1,
            1, -1, 1, 0,
            1, 0, 0, 0],
        h: [-1, 1, -1, -1,
            -1, 0, 1, 0,
            1, 1, 1, -1],
        i: [-1, 1, 1, 1,
            0, 1, 0, -1,
            -1, -1, 1, -1],
        j: [-1, -1, 1, -1,
            1, -1, 1, 1],
        k: [-1, 1, -1, -1,
            -1, 0, 1, 1,
            -1, 0, 1, -1],
        l: [-1, 1, -1, -1,
            -1, -1, 1, -1],
        m: [-1, -1, -1, 1,
            -1, 1, 0, 0.2,
            0, 0.2, 1, 1,
            1, 1, 1, -1],
        n: [-1, -1, -1, 1,
            -1, 1, 1, -1,
            1, -1, 1, 1],
        o: [1, 1, -1, 1,
            -1, 1, -1, -1,
            -1, -1, 1, -1,
            1, -1, 1, 1],
        p: [-1, -1, -1, 1,
            -1, 1, 1, 1,
            1, 1, 1, 0,
            1, 0, -1, 0],
        q: [1, 1, -1, 1,
            -1, 1, -1, -1,
            -1, -1, 0, -1,
            0, -1, 1, -0.4,
            1, -0.4, 1, 1,
            0, -0.4, 1, -1],
        r: [-1, -1, -1, 1,
            -1, 1, 1, 1,
            1, 1, 1, 0,
            1, 0, -1, 0,
            -0.2, 0, 1, -1],
        s: [1, 1, -1, 1,
            -1, 1, -1, 0,
            -1, 0, 1, 0,
            1, 0, 1, -1,
            1, -1, -1, -1],
        t: [-1, 1, 1, 1,
            0, 1, 0, -1],
        u: [-1, 1, -1, -1,
            -1, -1, 1, -1,
            1, -1, 1, 1],
        v: [-1, 1, 0, -1,
            0, -1, 1, 1],
        w: [-1, -1, -1, 1,
            -1, -1, 0, -0.2,
            0, -0.2, 1, -1,
            1, 1, 1, -1],
        x: [-1, 1, 1, -1,
            1, 1, -1, -1],
        y: [-1, 1, 0, 0.2,
            0, 0.2, 1, 1,
            0, 0.2, 0, -1],
        z: [-1, 1, 1, 1,
            1, 1, -1, -1,
            -1, -1, 1, -1],
        0: [1, 1, -1, 1,
            -1, 1, -1, -1,
            -1, -1, 1, -1,
            1, -1, 1, 1],
        1: [0, 1, 0, -1],
        2: [-1, 1, 1, 1,
            1, 1, 1, 0,
            1, 0, -1, 0,
            -1, 0, -1, -1,
            -1, -1, 1, -1],
        3: [-1, 1, 1, 1,
            -1, 0, 1, 0,
            -1, -1, 1, -1,
            1, 1, 1, -1],
        4: [-1, 1, -1, 0,
            1, 1, 1, -1,
            -1, 0, 1, 0],
        5: [1, 1, -1, 1,
            -1, 1, -1, 0,
            -1, 0, 1, 0,
            1, 0, 1, -1,
            1, -1, -1, -1],
        6: [-1, 1, -1, -1,
            1, 0, 1, -1,
            -1, 0, 1, 0,
            -1, -1, 1, -1],
        7: [-1, 1, 1, 1,
            1, 1, 1, -1],
        8: [1, 1, -1, 1,
            -1, 1, -1, -1,
            -1, -1, 1, -1,
            1, -1, 1, 1,
            -1, 0, 1, 0],
        9: [-1, 1, 1, 1,
            -1, 0, 1, 0,
            -1, 1, -1, 0,
            1, 1, 1, -1],
        ' ': [],
        '_': [-1, -1, 1, -1]
    };

    var characters = ' ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');

    function Character(char) {
        var pts = letterPoints[char];

        this.draw = function(x, y, w, h, g) {
            for (var i = 0; i < pts.length; i += 4) {
                g.moveTo(pts[i] * w / 2 + x, -pts[i + 1] * h / 2 + y);
                g.lineTo(pts[i + 2] * w / 2 + x, -pts[i + 3] * h / 2 + y);
            }
        };
    }

    function Text(text, lw, lh, x, y) {
        var characters = new Array(text.length);
        this.x = x || 0;
        this.y = y || 0;
        this.lw = lw;
        this.lh = lh;

        text = text.toLowerCase();
        for (var i = 0; i < text.length; i++) {
            characters[i] = new Character(text[i]);
        }

        this.draw = function(g) {
            for (var i = 0; i < characters.length; i++) {
                characters[i].draw(
                    this.x + this.lw / 2 + (this.lw * i * 1.3), 
                    this.y + this.lh / 2, 
                    this.lw, 
                    this.lh, g);
            }
        };

        this.measure = function() {
            return {
                w: this.lw * 1.3 * characters.length,
                h: this.lh
            }
        }
    }
        
    return {
        Text: Text,
        characters: characters
    };
})();